<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JoJo Geek Catalog</title>
    <link rel="stylesheet" href="styles/variables.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/responsive.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-controls">
                <div class="search-container">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" 
                              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Buscar series...">
                </div>
                <button class="filter-toggle" id="filterToggle">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M22 3H2L10 12.46V19L14 21V12.46L22 3Z" 
                              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                
                <a href="pages/noticias.html" class="noticias-toggle" id="noticiasToggle">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0" 
                              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="noticias-count" id="noticiasCount">0</span>
                </a>
                
                <a href="pages/lista-deseos.html" class="wishlist-toggle" id="wishlistToggle">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" 
                              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="wishlist-count" id="wishlistCount">0</span>
                </a>

                <button class="about-toggle" id="aboutToggle">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z" 
                              stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" 
                              stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </nav>

        <div class="filters-chips-panel" id="filtersChipsPanel">
            <div class="filters-section">
                <h4 class="filters-section-title">G√©nero</h4>
                <div class="chips-container" id="genreChips"></div>
            </div>
            
            <div class="filters-section">
                <h4 class="filters-section-title">Estado</h4>
                <div class="chips-container" id="statusChips"></div>
            </div>
        </div>

        <div class="about-panel" id="aboutPanel">
            <div class="about-content">
                <div class="about-header">
                    <h3>JoJo Geek Catalog</h3>
                    <button class="about-close" id="aboutClose">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M18 6L6 18M6 6l12 12" 
                                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                
                <div class="about-sections">
                    <div class="about-section">
                        <h4>‚ÑπÔ∏è Acerca del Cat√°logo</h4>
                        <div class="site-info">
                            <p>JoJo Geek Catalog es una plataforma dedicada a los amantes del mundo Geek, ofreciendo un cat√°logo completo de series/pel√≠culas con sistema de seguimiento personalizado.</p>
                            <ul class="features-list">
                                <li>üì∫ Cat√°logo completo de series/pel√≠culas</li>
                                <li>üíæ Lista de deseos personalizada</li>
                                <li>üì∞ Noticias actualizadas</li>
                                <li>üéØ Sistema de seguimiento de series/pel√≠culas</li>
                                <li>‚ö° Optimizaci√≥n avanzada de im√°genes</li>
                            </ul>
                            
                            <div class="version-info">
                                <strong>Versi√≥n 2.0.0</strong>
                                <span>Actualizado: Octubre 2025</span>
                                
                                <div class="changelog">
                                    <strong>üìù Registro de cambios:</strong>
                                    <ul class="changelog-list">
                                        <li>‚úÖ Se ha mejorado el sistema de compresi√≥n de im√°genes para que los tiempos de carga sean m√°s r√°pidos</li>
                                        <li>‚úÖ Se ha mejorado el sistema de cach√© de im√°genes</li>
                                        <li>‚úÖ Optimizaciones varias y soluci√≥n de errores menores</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="about-section">
                        <h4>üè™ Informaci√≥n:</h4>
                        <div class="business-info">
                            <div class="business-details">
                                <strong>Anime Store JoJo</strong>
                                <p>Tu tienda confiable de series y pel√≠culas</p>
                                <div class="business-contact">
                                    <div class="contact-item">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z" 
                                                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        <a href="https://wa.me/+5351930214">El wasa de Juan</a>
                                    </div>
                                    <div class="contact-item">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z" 
                                                  stroke="currentColor" stroke-width="2"/>
                                            <circle cx="12" cy="10" r="3" 
                                                    stroke="currentColor" stroke-width="2"/>
                                        </svg>
                                        <span>Mor√≥n: Luz caballero #106 entre San Jos√© y Seraf√≠n S√°nchez</span>
                                    </div>
                                    <div class="contact-item">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" 
                                                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        <span>Lun-Vie: 10:00 - 20:00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="about-section">
                        <h4>Cr√©ditos:</h4>
                        <div class="creator-info">
                            <div class="creator-details">
                                <strong>Desarrollado Por:</strong>
                                <p> A :I</p>
                                <strong>Menci√≥n Especial:</strong>
                                <p> El pinche Juan</p>
                                <div class="creator-links">
                                    <a href="https://chat.whatsapp.com/JsiBEty4A0H0IVymWXsyQ7" class="contact-link" target="_blank">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z" 
                                                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        Entra al grupo oficial
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="about-footer">
                    <p>¬°Gracias por visitar JoJo Geek Catalog! üéâ</p>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="hero">
            <h2>JoJo Geek Catalog</h2>
            <p>Encuentra tus favoritas y descubre nuevas</p>
        </section>

        <section class="series-grid" id="seriesGrid"></section>
    </main>

    <footer>
        <p>&copy; 2025 JoJo Geek Catalog</p>
    </footer>

    <div class="about-overlay" id="aboutOverlay"></div>

    <script src="scripts/image-optimizer.js"></script>
    <script src="scripts/data.js"></script>
    <script src="scripts/main.js"></script>

    <script>
        // ‚úÖ SERVICE WORKER MEJORADO - Cache Persistente entre p√°ginas
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('‚úÖ Service Worker registrado:', registration);
                    
                    // üîÑ Forzar actualizaci√≥n inmediata
                    if (registration.waiting) {
                        registration.waiting.postMessage('skipWaiting');
                        console.log('üîÑ Service Worker actualizado');
                    }
                    
                    // üìä Monitorizar estado del cache
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('üÜï Nueva versi√≥n del Service Worker encontrada:', newWorker);
                    });

                    // üõ†Ô∏è DEBUG HELPERS MEJORADOS
                    window.getCacheStatus = async () => {
                        if ('caches' in window) {
                            const cache = await caches.open('jojo-images-2.0');
                            const keys = await cache.keys();
                            let totalSize = 0;
                            
                            for (const request of keys) {
                                const response = await cache.match(request);
                                if (response) {
                                    const blob = await response.blob();
                                    totalSize += blob.size;
                                }
                            }
                            
                            const stats = {
                                count: keys.length,
                                size: (totalSize / 1024 / 1024).toFixed(2) + ' MB',
                                images: keys.map(k => k.url.split('/').pop())
                            };
                            
                            console.log('üíæ Estado del Cache:', stats);
                            return stats;
                        }
                        return { error: 'Cache API no disponible' };
                    };

                    window.clearAllCache = async () => {
                        if ('caches' in window) {
                            const cacheNames = await caches.keys();
                            for (const cacheName of cacheNames) {
                                if (cacheName.startsWith('jojo-')) {
                                    await caches.delete(cacheName);
                                    console.log('üóëÔ∏è Eliminado:', cacheName);
                                }
                            }
                            console.log('‚úÖ Todo el cache limpiado');
                            location.reload();
                        }
                    };

                    console.log('üöÄ Sistema de cache persistente activado');
                    console.log('üí° Comandos disponibles: getCacheStatus(), clearAllCache()');
                    
                } catch (error) {
                    console.error('‚ùå Error con Service Worker:', error);
                }
            });
        }

        // üîç Verificar sistemas al cargar
        window.checkSystems = () => {
            console.log('üîç Estado de sistemas:');
            console.log('- Service Worker:', 'serviceWorker' in navigator ? '‚úÖ Soportado' : '‚ùå No soportado');
            console.log('- Cache API:', 'caches' in window ? '‚úÖ Disponible' : '‚ùå No disponible');
            console.log('- Image Optimizer:', window.optimizedImageManager ? '‚úÖ Activo' : '‚ùå Inactivo');
        };

        // Ejecutar verificaci√≥n
        setTimeout(() => {
            window.checkSystems();
        }, 2000);
    </script>

    <style>
        .changelog {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--card-border);
        }

        .changelog strong {
            display: block;
            color: var(--accent);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .changelog-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .changelog-list li {
            color: var(--text-secondary);
            font-size: 0.8rem;
            padding: 0.3rem 0;
            padding-left: 1rem;
            position: relative;
            line-height: 1.4;
        }

        .changelog-list li:before {
            content: '‚Ä¢';
            color: var(--accent);
            position: absolute;
            left: 0.3rem;
            font-weight: bold;
        }

        .version-info {
            background: var(--bg-primary);
            padding: 1.2rem;
            border-radius: 8px;
            text-align: left;
        }

        .version-info strong {
            display: block;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
            font-size: 1rem;
        }

        .version-info span {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
    </style>
</body>
</html>